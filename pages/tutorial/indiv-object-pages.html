{% extends "base.html" %}

{% block title %}Chapter 8: Setting Up Individual Object Pages - {{ block.super }}{% endblock %}

{% block analytics %}
analytics.page("Chapter 8: Setting Up Individual Object Pages");
{% endblock %}

{% block bodyclass %}
<body id="tutorial">
{% endblock %}

{% block content %}
<div class="jumbotron"></div>
<div class="container">
        <div class="row">
        <div class="col-md-9 col-md-offset-3">
            <h1>Setting Up Individual Object Pages</h1>
        </div>
        <div class="col-md-3 text-right hidden-sm-down" style="padding-right: 40px;">
                    <section class="sharing">
                        <div>
                            <a class="twitter" href="http://twitter.com/home/?status={{ title }} https://hellowebbooks.com/{{ path|cut:".html" }}/ (via @hellowebapp)"><i class="fa fa-twitter"></i></a>

                            <a class="facebook" href="#" onclick="
                                window.open(
                                'https://www.facebook.com/sharer/sharer.php?u='+encodeURIComponent(location.href), 
                                'facebook-share-dialog', 
                                'width=626,height=436'); 
                                return false;"><i class="fa fa-facebook"></i> 
                            </a>
                            <a class="mail" href="mailto:?subject={{ title }}&amp;body=Here's the link: https://hellowebbooks.com/{{ path|cut:".html" }}/"><i class="fa fa-envelope"></i></a>
                        </div>
                    </section> 
            <h3>Next chapter:</h3>
            <ol class="list-unstyled toc">
                <li><a href="{% url '/tutorial/forms.html' %}">Forms.py Funsies</a></li>
            </ol>
            <h3>Previous chapter:</h3>
            <ol class="list-unstyled toc">
                <li><a href="{% url '/tutorial/dynamic-templates.html' %}">Displaying Dynamic Information in the Templates</a></li>
            </ol>
            <h3>Buy the book:</h3>
            <ol class="list-unstyled toc">
                <li><a href="{% url '/order.html' %}">Order Hello Web App</a></li>
            </ol>
        </div>

        <div class="col-md-9">

{% filter markdown %}
We now have a list of all the objects in our database on our homepage — wouldn't
it be nice for each object to have its own page?

## Adding the new pages to our URL definitions

Following our usual URLs-views-templates routine, let's head over to the
*urls.py* file to add the new URL scheme for our new pages.

We're going to remove the commented out default stuff from before, and add a new
line:

*urls.py*
{% endfilter %}

<pre><code class="python">
urlpatterns = [
    path('', views.index, name='home'),
    path('about/', 
        TemplateView.as_view(template_name='about.html'),
        name='about'),
    path('contact/', 
        TemplateView.as_view(template_name='contact.html'),
        name='contact'),
    <b>path('things/&lt;slug&gt;/', views.thing_detail, 
        name='thing_detail'),</b>
    path(r'^admin/', admin.site.urls),
]
</code></pre>

{% filter markdown %}
Cool, we have a new way to define our URLs that have dynamic content!

Going over the bits in the new line:

* `path()`: The path definition.
* `'things/<slug>/'`: This path will always start with "**things/**" and accepts
any word after, which we will name "slug" and send it onto the view. The
less-than and greater-than symbols indicates that variable content will be
accepted. So this'll match paths like
"**www.example.com/things/title-of-thing**",
"**www.example.com/things/title-of-different-thing**", and any other slug of the
objects in our database. 
* `views.thing_detail`: We're using the soon-to-be-created `thing_detail` view.
* `name='thing_detail`: And this URL is named `thing_detail`.

## Create the view

Our second view, woohoo!

Head back to `views.py` and add the new view in:

*views.py*
{% endfilter %}

<pre><code class="python">
from django.shortcuts import render
from collection.models import Thing

def index(request):
    things = Thing.objects.all()
    return render(request, 'index.html', {
        'things': things,
    })

# our new view
<b>def thing_detail(request, slug):
    # grab the object...
    thing = Thing.objects.get(slug=slug)

    # and pass to the template
    return render(request, 'things/thing_detail.html', {
        'thing': thing,
    })</b>
</code></pre>

{% filter markdown %}
Fairly simple. Note that at the top of the view, we now have `slug` passed in
from `urls.py` — remember that this was what was in that big, scary regex bit.

And now to the template...

## Setting up the template

We'll need to create the new HTML file that the view indicates.
{% endfilter %}

<pre><code class="sh">
<span class="cmd">$</span> cd collection/templates
<span class="cmd">collection/templates $</span> mkdir things
<span class="cmd">collection/templates $</span> cd things
<span class="cmd">collection/templates/things $</span> cp ../index.html thing_detail.html
</code></pre>

{% filter markdown %}

We could write `touch thing_detail.html` to create a blank file, but to avoid
writing out the content blocks and save us some typing, we'll just copy the
index file.

Of course, feel free to update 'thing' and 'things' here to match what you're
building (don't forget to update the view if you do so). We're putting the
detail page under a separate folder to keep all the templates that deal with
individual things in one place.

Here's our new individual object HTML template:

*thing_detail.html*
{% endfilter %}

{% verbatim %}
<pre><code class="django">
{% extends 'base.html' %}
{% block title %}
    {{ thing.name }} - {{ block.super }}
{% endblock title %}

{% block content %}
    &lt;h1&gt;{{ thing.name }}&lt;/h1&gt;
    &lt;p&gt;{{ thing.description }}&lt;/p&gt;
{% endblock content %}
</code></pre>

<p><code>{{ thing }}</code> is the object we passed in from the database, and we can access
the fields we set in the model (name and description) by adding the model field
after a dot — basically, <code>{{ thing.name }}</code>.</p>
{% endverbatim %}

{% filter markdown %}
How do we get to these individual pages? Let's update our index view to make the
list of objects we're displaying to link to their individual pages.

Our new *index.html* template:
{% endfilter %}

{% verbatim %}
<pre><code class="django">
{% extends 'base.html' %}
{% block title %}
    Homepage - {{ block.super }}
{% endblock title %}

{% block content %}
    <b>{% for thing in things %}
    &lt;h2&gt;
        &lt;a href="{% url 'thing_detail' slug=thing.slug %}"&gt;
            {{ thing.name }}
        &lt;/a&gt;
    &lt;/h2&gt;
    &lt;p&gt;{{ thing.description }}&lt;/p&gt;
    {% endfor %}</b>
{% endblock content %}
</code></pre>
{% endverbatim %}

{% filter markdown %}

We're going to use Django's named URLs again. We named our detail pages (back in
*urls.py*) `thing_detail`, and we also need to pass in the slug so it knows
which exact `thing` to make a link for.

Now we have an index page full of links:
{% endfilter %}

<figure class="caption">
    <img src="/static/images/tutorial/index_links.png" alt=""/>
</figure>

{% filter markdown %}
Which link to the object's respective page:
{% endfilter %}

<figure class="caption">
    <img src="/static/images/tutorial/individual_page.png" alt=""/>
</figure>

{% filter markdown %}
We are one step toward a working website that's useful to visitors and potential
customers! Don't forget to commit your work.

{% endfilter %}

{% include 'includes/tutorial-footer.html' with github="https://github.com/hellowebapp/hellowebapp-code/tree/chapter-8" nextname="Forms.py Funsies" nextlink="/tutorial/forms.html" prevname="Displaying Dynamic Information in the Templates" prevlink="/tutorial/dynamic-templates.html" title="Setting Up Individual Object Pages" path="/tutorial/indiv-object-pages.html" %}

{% include 'includes/newsletter.html' %}

{% endblock content %}

{% block scripts %}
{{ block.super }}
{% include 'includes/newsletter-analytics.html' %}
<link rel="stylesheet" href="{% static '/css/tomorrow.css' %}">
<script src="{% static '/js/highlight.pack.js' %}"></script>
<script>hljs.initHighlightingOnLoad();</script>
{% endblock scripts %}
